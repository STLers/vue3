{"version":3,"file":"reactivity.global.js","sources":["../../shared/src/index.ts","../src/reactive.ts"],"sourcesContent":["// 判断是否为对象\r\nexport function isObject(value) {\r\n    return value !== null && typeof value === 'object'\r\n}","import { isObject } from \"@vue/shared\"\r\n\r\nexport function reactive(target) {\r\n    return createReactive(target)\r\n}\r\n\r\nconst enum ReactiveFlags {\r\n    IS_REACTIVE = '__v_isReactive'\r\n}\r\n// 存储已经reactive包装的对象\r\nconst reactiveMap = new WeakMap()\r\n// proxy代理\r\nconst mutableHandlers = {\r\n    get (target, key, receiver) {\r\n        // 避免重复包装已经reactive处理的对象\r\n        if (key === ReactiveFlags.IS_REACTIVE) {\r\n            return true\r\n        }\r\n        const ret = Reflect.get(target, key, receiver)\r\n        return ret\r\n    },\r\n    set (target, key, value, receiver) {\r\n        const ret = Reflect.set(target, key, value, receiver)\r\n        return ret\r\n    }\r\n}\r\nfunction createReactive(target) {\r\n    // 避免重复包装已经reactive处理的对象\r\n    if (target[ReactiveFlags.IS_REACTIVE]) {\r\n        return target\r\n    }\r\n    // 判断是否已经存在reactive类型的target\r\n    const exitingProxy = reactiveMap.get(target)\r\n    if (exitingProxy) {\r\n        return exitingProxy\r\n    }\r\n    // 只处理对象\r\n    if (!isObject(target)) {\r\n        return target\r\n    }\r\n    const proxy = new Proxy(target, mutableHandlers)\r\n    // 存储target，防止重复代理\r\n    reactiveMap.set(target, proxy)\r\n    return proxy\r\n}"],"names":[],"mappings":";;;IAAA;aACgB,QAAQ,CAAC,KAAK;QAC1B,OAAO,KAAK,KAAK,IAAI,IAAI,OAAO,KAAK,KAAK,QAAQ,CAAA;IACtD;;aCDgB,QAAQ,CAAC,MAAM;QAC3B,OAAO,cAAc,CAAC,MAAM,CAAC,CAAA;IACjC,CAAC;IAKD;IACA,MAAM,WAAW,GAAG,IAAI,OAAO,EAAE,CAAA;IACjC;IACA,MAAM,eAAe,GAAG;QACpB,GAAG,CAAE,MAAM,EAAE,GAAG,EAAE,QAAQ;;YAEtB,IAAI,GAAG,yCAAgC;gBACnC,OAAO,IAAI,CAAA;aACd;YACD,MAAM,GAAG,GAAG,OAAO,CAAC,GAAG,CAAC,MAAM,EAAE,GAAG,EAAE,QAAQ,CAAC,CAAA;YAC9C,OAAO,GAAG,CAAA;SACb;QACD,GAAG,CAAE,MAAM,EAAE,GAAG,EAAE,KAAK,EAAE,QAAQ;YAC7B,MAAM,GAAG,GAAG,OAAO,CAAC,GAAG,CAAC,MAAM,EAAE,GAAG,EAAE,KAAK,EAAE,QAAQ,CAAC,CAAA;YACrD,OAAO,GAAG,CAAA;SACb;KACJ,CAAA;IACD,SAAS,cAAc,CAAC,MAAM;;QAE1B,IAAI,MAAM,oCAA2B,EAAE;YACnC,OAAO,MAAM,CAAA;SAChB;;QAED,MAAM,YAAY,GAAG,WAAW,CAAC,GAAG,CAAC,MAAM,CAAC,CAAA;QAC5C,IAAI,YAAY,EAAE;YACd,OAAO,YAAY,CAAA;SACtB;;QAED,IAAI,CAAC,QAAQ,CAAC,MAAM,CAAC,EAAE;YACnB,OAAO,MAAM,CAAA;SAChB;QACD,MAAM,KAAK,GAAG,IAAI,KAAK,CAAC,MAAM,EAAE,eAAe,CAAC,CAAA;;QAEhD,WAAW,CAAC,GAAG,CAAC,MAAM,EAAE,KAAK,CAAC,CAAA;QAC9B,OAAO,KAAK,CAAA;IAChB;;;;;;;;;;;;"}